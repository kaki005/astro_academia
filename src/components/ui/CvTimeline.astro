---
import { isExperience } from "@/types/cv";
import type { Experience, Education } from "@/types/cv";
import { locales, getMessages, getTranslations } from "../../i18n";
interface Props {
	elements: (Experience | Education)[];
	colored: boolean;
	locale?: string;
}
const { elements, colored, locale } = Astro.props;
const messages = getMessages(locale);
function formatDate(date: Date, lang: string) {
	return date.toLocaleDateString(lang === "ja" ? "ja-JP" : "en-US", {
		year: "numeric",
		month: lang === "ja" ? "long" : "short",
		// day: "numeric",
	});
}
---

<ul
	class="timeline timeline-snap-icon max-md:timeline-compact timeline-vertical"
>
	{
		elements.map((element, index) => (
			<li>
				<div class="timeline-middle">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 20 20"
						fill="currentColor"
						class:list={[{ "text-accent": colored }, "h-5 w-5"]}
					>
						<path
							fill-rule="evenodd"
							d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z"
							clip-rule="evenodd"
						/>
					</svg>
				</div>
				<div
					class={`${index % 2 === 0 ? "timeline-start" : "timeline-end"} mb-10 md:text-end`}
				>
					<time
						class="font-mono italic"
						datetime={element.start.toISOString()}
					>
						{formatDate(element.start)}
					</time>
					<div class="text-lg font-black">
						{/* {isExperience(element) ? element.title : element.degree} */}
						{messages.Role[element.role].name}
					</div>
					<div>{messages.Role[element.role].description}</div>
					<div>{messages.Facurity[element.facurity]}</div>
					<div>{messages.Location[element.location]}</div>
					{element.end != null ? (
						<time
							class="font-mono italic"
							datetime={element.end.toISOString()}
						>
							{formatDate(element.end)}
						</time>
					) : (
						<time class="font-mono italic">On</time>
					)}
				</div>
				<hr class:list={[{ "bg-accent": colored }]} />
			</li>
		))
	}
</ul>
