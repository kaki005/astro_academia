---
import { isExperience } from "@/types/cv";
import type { Experience, Education } from "@/types/cv";
import { Icon } from "@/components/ui/icon";
import type { AstroComponentFactory } from "astro";
import TimeDisplay from "@/components/ui/TimeDisplay.astro";
interface Props {
	elements: (Experience | Education)[];
	locale?: string;
	ChildItem?: AstroComponentFactory;
}
const { elements, locale, ChildItem } = Astro.props;
function formatDate(date: Date, lang: string) {
	return date.toLocaleDateString(lang === "ja" ? "ja-JP" : "en-US", {
		year: "numeric",
		// month: lang === "ja" ? "long" : "short",
		month: "long",
		// day: "numeric",
	});
}
const ORIGINAL_LIST = elements;
const REVERSED_LIST = [...ORIGINAL_LIST].reverse();
const TIME_CLASS =
	"bg-neutral-secondary-medium border border-default-medium text-heading text-xs font-medium px-1.5 py-0.5 rounded";
---

<!-- sm以上 -->
<div class="hidden sm:block">
	<ol class="items-center flex">
		{
			ORIGINAL_LIST.map((element, index) => (
				<li class="relative mb-0 flex-1">
					<div class="flex items-center">
						<div class="z-10 flex items-center justify-center w-6 h-6 bg-brand-softer rounded-full ring-buffer ring-4 shrink-0">
							<Icon name="calendar" />
						</div>
						<div class="flex flex-1 bg-blue-200 h-px" />
					</div>
					<div class="mt-3 pe-8">
						<TimeDisplay
							start={element.start}
							locale={locale}
							end={element.end}
							tilde_style="top-1"
						/>
						{ChildItem != null && (
							<ChildItem item={element} locale={locale} />
						)}
					</div>
				</li>
			))
		}
	</ol>
</div>

<!-- sm未満 -->
<div class="block sm:hidden">
	<ol class="relative border-s border-blue-200">
		{
			REVERSED_LIST.map((element, index) => (
				<li class="mb-4 ms-6">
					<span class="absolute flex items-center justify-center w-6 h-6 bg-brand-softer rounded-full -start-3 translate-y-2 ring-4 ring-buffer bg-white">
						<Icon name="calendar" />
					</span>
					<TimeDisplay
						start={element.start}
						locale={locale}
						end={element.end}
						tilde_style="top-0.5"
					/>
					{ChildItem != null && (
						<ChildItem item={element} locale={locale} />
					)}
				</li>
			))
		}
	</ol>
</div>
